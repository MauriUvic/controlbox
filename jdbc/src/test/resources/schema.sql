DROP
Database IF EXISTS controlbox_test;
CREATE
DATABASE IF NOT EXISTS controlbox_test;
USE
controlbox_test;

CREATE TABLE IF NOT EXISTS PRODUCT
(
    ID
    BIGINT
    PRIMARY
    KEY
    AUTO_INCREMENT,
    NAME
    VARCHAR
(
    255
) NOT NULL,
    DESCRIPTION TEXT,
    PRICE DOUBLE,
    STOCK INT
    );

CREATE TABLE IF NOT EXISTS SUPPLIER
(
    ID
    BIGINT
    PRIMARY
    KEY
    AUTO_INCREMENT,
    NAME
    VARCHAR
(
    255
) NOT NULL,
    CONTACT_NAME VARCHAR
(
    255
),
    EMAIL VARCHAR
(
    255
),
    PHONE VARCHAR
(
    20
),
    ADDRESS TEXT
    );

CREATE TABLE IF NOT EXISTS REQUEST
(
    ID
    BIGINT
    PRIMARY
    KEY
    AUTO_INCREMENT,
    PRODUCT_ID
    BIGINT,
    QUANTITY
    INT,
    STATUS
    VARCHAR
(
    50
),
    REQUEST_DATE VARCHAR
(
    20
),
    RESOLUTION_DATE VARCHAR
(
    20
),
    REQUESTER VARCHAR
(
    255
),
    FOREIGN KEY
(
    PRODUCT_ID
) REFERENCES PRODUCT
(
    ID
) ON DELETE CASCADE
    );

CREATE TABLE IF NOT EXISTS MOVEMENT
(
    ID
    BIGINT
    PRIMARY
    KEY
    AUTO_INCREMENT,
    PRODUCT_ID
    BIGINT,
    TYPE
    VARCHAR
(
    50
),
    QUANTITY INT,
    DATE VARCHAR
(
    40
),
    REFERENCE VARCHAR
(
    255
),
    FOREIGN KEY
(
    PRODUCT_ID
) REFERENCES PRODUCT
(
    ID
) ON DELETE CASCADE
    );

CREATE TABLE IF NOT EXISTS `ORDER`
(
    ID
    BIGINT
    PRIMARY
    KEY
    AUTO_INCREMENT,
    SUPPLIER_ID
    BIGINT,
    DATE
    VARCHAR
(
    20
),
    TOTAL_AMOUNT DOUBLE,
    STATUS VARCHAR
(
    50
),
    DELIVERY_DATE VARCHAR
(
    20
),
    FOREIGN KEY
(
    SUPPLIER_ID
) REFERENCES SUPPLIER
(
    ID
) ON DELETE CASCADE
    );

CREATE TABLE IF NOT EXISTS ORDER_DETAIL
(
    ID
    BIGINT
    PRIMARY
    KEY
    AUTO_INCREMENT,
    ORDER_ID
    BIGINT,
    PRODUCT_ID
    BIGINT,
    QUANTITY
    INT,
    UNIT_PRICE
    DOUBLE,
    FOREIGN
    KEY
(
    ORDER_ID
) REFERENCES `ORDER`
(
    ID
) ON DELETE CASCADE,
    FOREIGN KEY
(
    PRODUCT_ID
) REFERENCES PRODUCT
(
    ID
)
  ON DELETE CASCADE
    );